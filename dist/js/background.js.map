{"version":3,"file":"background.js","mappings":";;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,mBAAmB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA,+BAA+B,kCAAkC;AACjE;AACA;AACA;AACA;AACA,mCAAmC,SAAS;AAC5C,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,KAAK,GAAG,MAAM,GAAG,IAAI;AACvC;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B;AAC7D,iCAAiC,MAAM,QAAQ,iBAAiB;AAChE,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,uCAAuC,aAAa;AACpD;AACA;AACA;AACA;AACyB;;;;;;;UC7FzB;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA,E;;;;;WCPA,wF;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D,E;;;;;;;;;;;;ACNgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC;AACD;AACA;AACA,+BAA+B,UAAU,eAAe;AACxD,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,QAAQ;AAC/C,SAAS;AACT;AACA;AACA,CAAC;AACD;AACA,6BAA6B,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,GAAG;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,eAAe;AACrD;AACA;AACA,4DAA4D;AAC5D;AACA;AACA,wBAAwB,yDAAa;AACrC,qDAAqD,UAAU;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,gBAAgB;AAClE;AACA;AACA,uCAAuC,QAAQ;AAC/C;AACA;AACA,CAAC","sources":["webpack://pixiv-fanbox-downloader/./src/ts/TotalDownload.ts","webpack://pixiv-fanbox-downloader/webpack/bootstrap","webpack://pixiv-fanbox-downloader/webpack/runtime/define property getters","webpack://pixiv-fanbox-downloader/webpack/runtime/hasOwnProperty shorthand","webpack://pixiv-fanbox-downloader/webpack/runtime/make namespace object","webpack://pixiv-fanbox-downloader/./src/ts/background.ts"],"sourcesContent":["class TotalDownload {\n    constructor() {\n        /** è®°å½•æ¯å¤©çš„ä¸‹è½½æ€»ä½“ç§¯ã€‚key æ˜¯å½“å¤©çš„ dateï¼Œvalue æ˜¯å½“å¤©çš„ä¸‹è½½æ€»é‡ï¼ˆå­—èŠ‚æ•°ï¼‰ */\n        this.data = {};\n        this.init();\n    }\n    init() {\n        // åˆå§‹åŒ–å­˜å‚¨\n        chrome.runtime.onInstalled.addListener((details) => {\n            if (details.reason === 'install') {\n                chrome.storage.local.set({ totalDownload: {} }, () => {\n                    if (chrome.runtime.lastError) {\n                        console.error('åˆå§‹åŒ–å­˜å‚¨å¤±è´¥:', chrome.runtime.lastError.message);\n                    }\n                    else {\n                        console.log('totalDownload åˆå§‹åŒ–æˆåŠŸ');\n                    }\n                });\n            }\n        });\n        chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\n            if (request.msg === 'getTotalDownload') {\n                // è¿”å›ä»Šå¤©çš„æ•°æ®\n                sendResponse({ total: this.data[this.getDate()] });\n            }\n            else if (request.msg === 'getTotalDownloadHistory30') {\n                // è¿”å›æœ€è¿‘ 30 å¤©çš„æ•°æ®ï¼ˆè™½ç„¶å¯ä»¥è¿”å›æ‰€æœ‰æ•°æ®ï¼Œä½†æ˜¯å¤©æ•°å¤ªå¤šçš„è¯ï¼Œå‰å°ä¸å¥½å±•ç¤ºï¼‰\n                this.getLast30DaysData().then((history) => {\n                    sendResponse({ history });\n                });\n                // ç”±äºè¿™ä¸ª sendResponse æ˜¯å¼‚æ­¥ï¼Œæ‰€ä»¥éœ€è¦è¿”å› true è®©æ¶ˆæ¯ç«¯å£ä¸è¦å…³é—­\n                // Return true to keep the message port open for async response\n                return true;\n            }\n            else {\n                // Return false for unhandled messages\n                return false;\n            }\n        });\n        // åŠ è½½ totalDownload\n        setTimeout(() => {\n            this.restore();\n        }, 0);\n    }\n    async restore() {\n        const result = await chrome.storage.local.get(['totalDownload']);\n        this.data = result.totalDownload || {};\n    }\n    /** ç”Ÿæˆ YYYY-MM-DD æ ¼å¼çš„å½“å‰æ—¥æœŸ */\n    getDate() {\n        const date = new Date();\n        const year = date.getFullYear();\n        const month = (date.getMonth() + 1).toString().padStart(2, '0');\n        const day = date.getDate().toString().padStart(2, '0');\n        return `${year}-${month}-${day}`;\n    }\n    // æ·»åŠ ä¸‹è½½é‡\n    addDownload(bytes) {\n        const date = this.getDate();\n        this.data[date] = (this.data[date] || 0) + bytes;\n        chrome.storage.local.set({ totalDownload: this.data }, () => {\n            // console.log(`æ›´æ–° ${date} çš„ä¸‹è½½é‡: ${this.data[date]} å­—èŠ‚`)\n        });\n    }\n    /**\n     * è·å–æœ€è¿‘ 30 å¤©çš„æ•°æ®ï¼ˆåŒ…æ‹¬ä»Šå¤©ï¼‰ï¼Œä»¥æ•°ç»„å½¢å¼è¿”å›\n     */\n    async getLast30DaysData() {\n        // å¦‚æœæ˜¯ç©ºå¯¹è±¡ï¼Œå¯èƒ½å°šæœªä» local storage é‡ŒåŠ è½½æ•°æ®ï¼Œå°è¯•é‡æ–°åŠ è½½ä¸€æ¬¡\n        // ä¾‹å¦‚åå°è„šæœ¬è¢«å›æ”¶äº†ï¼Œå‰å°å´è¦æŸ¥çœ‹æ•°æ®, äºæ˜¯åå°è„šæœ¬è¢«å†æ¬¡æ‰§è¡Œï¼Œæ­¤æ—¶å¯èƒ½è¿˜æ˜¯é»˜è®¤å€¼\n        if (Object.keys(this.data).length === 0) {\n            await this.restore();\n        }\n        const today = new Date();\n        const thirtyDaysAgo = new Date(today);\n        thirtyDaysAgo.setDate(today.getDate() - 29);\n        const result = Object.entries(this.data)\n            .filter(([dateStr]) => {\n            // æ·»åŠ  T00:00:00 ä½¿æ—¥æœŸåˆå§‹åŒ–ä¸ºæœ¬åœ°æ—¶é—´ 0 ç‚¹\n            // å¦‚æœä¸å¸¦ T éƒ¨åˆ†ï¼ŒJavaScript ä¼šå‡è®¾æ—¶é—´ä¸º UTC æ—¶é—´çš„ 00:00:00\n            // ç„¶åï¼ŒDate å¯¹è±¡ä¼šå°†è¿™ä¸ª UTC æ—¶é—´è½¬æ¢ä¸ºæœ¬åœ°æ—¶åŒºï¼ˆå¦‚é¦™æ¸¯æ ‡å‡†æ—¶é—´ä¸º GMT+0800ï¼‰\n            // å¦‚æœå¸¦ Tï¼Œä¸”ä¸å¸¦æ—¶åŒºæ ‡è¯†ç¬¦ï¼ˆå¦‚ Z æˆ– +08:00ï¼‰æ—¶ï¼ŒJavaScript ä¼šå‡å®šå®ƒæ˜¯æœ¬åœ°æ—¶é—´\n            // ä¹Ÿå°±æ˜¯ GMT+0000\n            // ç”±äºä¸‹è½½å™¨åœ¨å‚¨å­˜è®°å½•æ—¶ï¼Œæ˜¯ä½¿ç”¨ new Date() æ¥è·å–å¹´æœˆæ—¥çš„ï¼Œè¿™æ˜¯æœ¬åœ°æ—¶é—´\n            // æ‰€ä»¥è¿™é‡Œå¯¹æ¯”æ—¶é—´æ—¶ï¼Œä¹Ÿè¦åˆå§‹åŒ–ä¸ºæœ¬åœ°æ—¶é—´ï¼Œå³æŒ‡æ˜ T00:00:00\n            const date = new Date(dateStr + 'T00:00:00');\n            return !isNaN(date.getTime()) && date >= thirtyDaysAgo && date <= today;\n        })\n            .map(([date, bytes]) => ({ date, bytes }));\n        return result;\n    }\n}\nconst totalDownload = new TotalDownload();\nexport { totalDownload };\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { totalDownload } from './TotalDownload';\n// å½“ç‚¹å‡»æ‰©å±•å›¾æ ‡æ—¶ï¼Œæ˜¾ç¤º/éšè—ä¸‹è½½é¢æ¿\nchrome.action.onClicked.addListener(function (tab) {\n    // åœ¨æœ¬ç¨‹åºæ²¡æœ‰æƒé™çš„é¡µé¢ä¸Šç‚¹å‡»æ‰©å±•å›¾æ ‡æ—¶ï¼Œurl å§‹ç»ˆæ˜¯ undefinedï¼Œæ­¤æ—¶ä¸å‘é€æ¶ˆæ¯\n    if (!tab.url) {\n        return;\n    }\n    chrome.tabs.sendMessage(tab.id, {\n        msg: 'click_icon',\n    });\n});\n// å½“æ‰©å±•è¢«å®‰è£…ã€è¢«æ›´æ–°ã€æˆ–è€…æµè§ˆå™¨å‡çº§æ—¶ï¼Œåˆå§‹åŒ–æ•°æ®\nchrome.runtime.onInstalled.addListener((details) => {\n    chrome.storage.local.set({ dlData: {}, batchNo: {} });\n});\n/**å­˜å‚¨æ¯ä¸ªä¸‹è½½ä»»åŠ¡çš„æ•°æ®ã€‚\n *\n * å› ä¸ºä¸‹è½½å®Œæˆçš„é¡ºåºå’Œå‰å°å‘é€çš„é¡ºåºå¯èƒ½ä¸ä¸€è‡´ï¼Œæ‰€ä»¥éœ€è¦æŠŠæ•°æ®ä¿å­˜èµ·æ¥ä»¥ä¾›æŸ¥è¯¢ */\nlet dlData = {};\n/**ä½¿ç”¨æ¯ä¸ªé¡µé¢çš„ tabId ä½œä¸ºç´¢å¼•ï¼Œå‚¨å­˜å½“å‰ä¸‹è½½ä»»åŠ¡çš„æ‰¹æ¬¡ç¼–å·ï¼ˆåœ¨è¯¥é¡µé¢é‡Œï¼‰ã€‚ç”¨æ¥åˆ¤æ–­ä¸åŒæ‰¹æ¬¡çš„ä¸‹è½½ */\nlet batchNo = {};\nconst fileNameList = new Map();\n// æ¥æ”¶ä¸‹è½½è¯·æ±‚\nchrome.runtime.onMessage.addListener(async function (msg, sender) {\n    // æ¥æ”¶ä¸‹è½½ä»»åŠ¡\n    if (msg.msg === 'send_download') {\n        // å½“å¤„äºåˆå§‹çŠ¶æ€æ—¶ï¼Œæˆ–è€…å˜é‡è¢«å›æ”¶äº†ï¼Œå°±ä»å­˜å‚¨ä¸­è¯»å–æ•°æ®å‚¨å­˜åœ¨å˜é‡ä¸­\n        // ä¹‹åæ¯å½“è¦ä½¿ç”¨è¿™ä¸¤ä¸ªæ•°æ®æ—¶ï¼Œä»å˜é‡è¯»å–ï¼Œè€Œä¸æ˜¯ä»å­˜å‚¨ä¸­è·å¾—ã€‚è¿™æ ·å°±è§£å†³äº†æ•°æ®ä¸åŒæ­¥çš„é—®é¢˜ï¼Œè€Œä¸”æ€§èƒ½æ›´é«˜\n        if (Object.keys(batchNo).length === 0) {\n            const data = await chrome.storage.local.get(['batchNo', 'dlData']);\n            batchNo = data.batchNo;\n            dlData = data.dlData;\n        }\n        const tabId = sender.tab.id;\n        // å¦‚æœå¼€å§‹äº†æ–°ä¸€æ‰¹çš„ä¸‹è½½ï¼Œé‡è®¾æ‰¹æ¬¡ç¼–å·ï¼Œæ¸…ç©ºä¸‹è½½ç´¢å¼•\n        if (batchNo[tabId] !== msg.taskBatch) {\n            batchNo[tabId] = msg.taskBatch;\n            chrome.storage.local.set({ batchNo });\n        }\n        fileNameList.set(msg.fileUrl, msg.fileName);\n        // å¼€å§‹ä¸‹è½½\n        chrome.downloads.download({\n            url: msg.fileUrl,\n            filename: msg.fileName,\n            conflictAction: 'uniquify',\n            saveAs: false,\n        }, (id) => {\n            // id æ˜¯ Chrome æ–°å»ºç«‹çš„ä¸‹è½½ä»»åŠ¡çš„ id\n            dlData[id] = {\n                url: msg.fileUrl,\n                id: msg.id,\n                tabId: tabId,\n                uuid: false,\n                size: -1,\n            };\n            chrome.storage.local.set({ dlData });\n        });\n        return false;\n    }\n});\n// åˆ¤æ–­æ–‡ä»¶åæ˜¯å¦å˜æˆäº† UUID æ ¼å¼ã€‚å› ä¸ºæ–‡ä»¶åå¤„äºæ•´ä¸ªç»å¯¹è·¯å¾„çš„ä¸­é—´ï¼Œæ‰€ä»¥æ²¡åŠ é¦–å°¾æ ‡è®° ^ $\nconst UUIDRegexp = /[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}/;\n// ç›‘å¬ä¸‹è½½äº‹ä»¶\n// æ¯ä¸ªä¸‹è½½ä¼šè§¦å‘ä¸¤æ¬¡ onChanged äº‹ä»¶\nchrome.downloads.onChanged.addListener(async function (detail) {\n    var _a, _b, _c;\n    // æ ¹æ® detail.id å–å‡ºä¿å­˜çš„æ•°æ®\n    // å¦‚æœæœ‰æ•°æ®ï¼Œå°±æ˜¯æœ¬æ‰©å±•å»ºç«‹çš„ä¸‹è½½ï¼Œæ‰€ä»¥ä¸ä¼šç›‘å¬åˆ°éæœ¬æ‰©å±•å»ºç«‹çš„ä¸‹è½½\n    let data = dlData[detail.id];\n    if (!data) {\n        const getData = await chrome.storage.local.get(['dlData']);\n        dlData = getData.dlData;\n        data = dlData[detail.id];\n    }\n    if (data) {\n        let msg = '';\n        let err = '';\n        // åˆ¤æ–­å½“å‰æ–‡ä»¶åæ˜¯å¦æ­£å¸¸ã€‚ä¸‹è½½æ—¶å¿…å®šä¼šæœ‰ä¸€æ¬¡ detail.filename.current æœ‰å€¼\n        if (detail.filename && detail.filename.current) {\n            const changedName = detail.filename.current;\n            // æ–‡ä»¶åæ˜¯ UUID\n            if (changedName.match(UUIDRegexp) !== null) {\n                data.uuid = true;\n            }\n            if (changedName.endsWith('jfif')) {\n                data.uuid = true;\n            }\n            // æ£€æŸ¥æ–‡ä»¶åæ˜¯ URL é‡Œæœ€åä¸€æ®µçš„æƒ…å†µ\n            // Fanbox ä¸‹è½½å™¨çš„å¤šæ•°æ–‡ä»¶æ˜¯ç›´æ¥æŠŠåŸ URL å‘é€ç»™æµè§ˆå™¨ä¸‹è½½çš„ï¼Œå› æ­¤å¾ˆå¤šæ—¶å€™å³ä½¿å—åˆ°å…¶ä»–æ‰©å±•ç¨‹åºçš„å½±å“ï¼Œä¹Ÿä¸ä¼šæ˜¯ UUIDï¼Œè€Œæ˜¯åŸæ–‡ä»¶åï¼Œä¾‹å¦‚ï¼š\n            // https://pixiv.pximg.net/c/1200x630_90_a2_g5/fanbox/public/images/post/10264356/cover/cvfFotXy5Cbc2I0uakDXHG0s.jpeg\n            // å—åˆ°å½±å“æ—¶ï¼Œä¸Šé¢çš„å›¾ç‰‡ä¿å­˜åæ˜¯åŸæ–‡ä»¶åï¼š\n            // cvfFotXy5Cbc2I0uakDXHG0s.jpeg\n            // æ­¤æ—¶çš„ detail ç¤ºä¾‹ï¼š\n            // const detailExample = {\n            //   \"filename\": {\n            //      current åœ¨ windows ä¸Šå¯èƒ½æ˜¯è¿™æ ·çš„ï¼š\n            //     \"current\": \"C:\\\\download\\\\cvfFotXy5Cbc2I0uakDXHG0s (6).jpeg\",\n            //      current åœ¨ Linux ä¸Šå¯èƒ½æ˜¯è¿™æ ·çš„ï¼š\n            //     \"current\": \"/home/username/Downloads/cvfFotXy5Cbc2I0uakDXHG0s (6).jpeg\",\n            //     \"previous\": \"\"\n            //   },\n            //   \"id\": 1347\n            // }\n            // fileNameList é‡Œå‚¨å­˜çš„é¢„æœŸçš„æ–‡ä»¶åç¤ºä¾‹ï¼š\n            // fanbox/omutatsuï¼ãŠã‚€ãŸã¤/2025-07-22-ğŸ”7æœˆ22æ—¥ğŸ”/0.jpeg\n            const expectedName = fileNameList.get(data.url);\n            if (expectedName) {\n                // å–å‡ºé¢„æœŸçš„æ–‡ä»¶åçš„æœ€åä¸€éƒ¨åˆ†ï¼Œä¸Šé¢çš„æ–‡ä»¶åçš„ç»“æœæ˜¯ \"0\"\n                const name = ((_a = expectedName.split('/').pop()) === null || _a === void 0 ? void 0 : _a.split('.')[0]) || '';\n                // å–å‡ºå®é™…çš„æ–‡ä»¶åçš„æœ€åä¸€éƒ¨åˆ†ï¼ˆæ³¨æ„ï¼Œå³ä½¿æ˜¯ä¸é¢„æœŸä¸€è‡´çš„æ–‡ä»¶åï¼Œå®é™…ä¸Šä¹Ÿå¯èƒ½æœ‰åºå·ï¼‰\n                let name2 = '';\n                if (changedName.includes('\\\\')) {\n                    name2 = ((_b = changedName.split('\\\\').pop()) === null || _b === void 0 ? void 0 : _b.split('.')[0]) || '';\n                }\n                else {\n                    name2 = ((_c = changedName.split('/').pop()) === null || _c === void 0 ? void 0 : _c.split('.')[0]) || '';\n                }\n                // å¦‚æœå®é™…æ–‡ä»¶åä¸æ˜¯ä»¥é¢„æœŸçš„æ–‡ä»¶åå¼€å¤´ï¼Œåˆ™è¯´æ˜æ–‡ä»¶åå¼‚å¸¸\n                if (name2 && name2.startsWith(name) === false) {\n                    data.uuid = true;\n                }\n            }\n        }\n        if (detail.state && detail.state.current === 'complete') {\n            msg = 'downloaded';\n            // ä¸‹è½½å®Œæˆåï¼ŒæŸ¥è¯¢ä¸‹è½½é¡¹çš„ä½“ç§¯\n            // æŸ¥è¯¢èŠ±è´¹çš„æ—¶é—´ï¼šåœ¨ä¸‹è½½è®°å½•ä¸æ˜¯å¾ˆå¤šçš„æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢è€—æ—¶å¤šä¸º 2 - 5 ms\n            chrome.downloads.search({ id: detail.id }, (results) => {\n                if (results && results.length > 0) {\n                    const downloadItem = results[0];\n                    const fileSize = downloadItem.fileSize; // æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰\n                    if (fileSize !== -1) {\n                        data.size = fileSize;\n                        totalDownload.addDownload(fileSize);\n                        // console.log(`æ–‡ä»¶ä¸‹è½½å®Œæˆï¼Œå¤§å°: ${fileSize} å­—èŠ‚`)\n                    }\n                    else {\n                        // console.log(\"æ–‡ä»¶ä¸‹è½½å®Œæˆï¼Œä½†å¤§å°æœªçŸ¥\")\n                    }\n                }\n                else {\n                    // console.error(\"æœªæ‰¾åˆ°ä¸‹è½½é¡¹\")\n                }\n            });\n        }\n        if (detail.error && detail.error.current) {\n            // ä¸‹è½½è¢«å–æ¶ˆæˆ–è€…å¤±è´¥æ—¶ï¼Œè¿™é‡Œæ˜¯èƒ½æ•è·åˆ°é”™è¯¯çš„ï¼Œdetail.error.current åŒ…å«é”™è¯¯ç±»å‹ï¼š\n            // å–æ¶ˆ USER_CANCELED\n            // å¤±è´¥ NETWORK_FAILED\n            msg = 'download_err';\n            err = detail.error.current;\n        }\n        // è¿”å›ä¿¡æ¯\n        if (msg) {\n            chrome.tabs.sendMessage(data.tabId, { msg, data, err });\n            // æ¸…é™¤è¿™ä¸ªä»»åŠ¡çš„æ•°æ®\n            dlData[detail.id] = null;\n            chrome.storage.local.set({ dlData });\n        }\n    }\n});\n"],"names":[],"sourceRoot":""}